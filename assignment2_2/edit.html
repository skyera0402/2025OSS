<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <title>게임 수정 - Edit</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="my.css" rel="stylesheet">
</head>
<body>
<nav class="navbar navbar-expand-lg bg-body-tertiary border-bottom">
  <div class="container">
    <a class="navbar-brand header-brand" href="index.html"> Game CRUD</a>
  </div>
</nav>

<main class="page-wrap">
  <div class="card">
    <div class="card-body">
      <h4 class="mb-3">게임 수정</h4>

      <!-- 임의 레코드 값 미리 채움 -->
      <form id="editForm" novalidate>
        <div class="row g-3">
          <div class="col-md-6">
            <label class="form-label">게임 이름 *</label>
            <input type="text" class="form-control" id="title" value="Stellar Odyssey" required>
            <div class="invalid-feedback">게임 이름은 2~60자 사이로 입력하세요.</div>
          </div>
          <div class="col-md-3">
            <label class="form-label">가격(₩) *</label>
            <input type="number" class="form-control" id="price" min="0" step="100" value="29000" required>
            <div class="invalid-feedback">0 이상 정수(100원 단위 권장)로 입력하세요.</div>
          </div>
          <div class="col-md-3">
            <label class="form-label">플레이 시간(시간) *</label>
            <input type="number" class="form-control" id="hours" min="0" step="1" value="42" required>
            <div class="invalid-feedback">0 이상의 정수 시간으로 입력하세요.</div>
          </div>
          <div class="col-md-6">
            <label class="form-label">제작사 *</label>
            <input type="text" class="form-control" id="dev" value="NebulaWorks" required>
            <div class="invalid-feedback">제작사를 입력하세요(2~40자).</div>
          </div>
          <div class="col-md-3">
            <label class="form-label">출시년도 *</label>
            <input type="number" class="form-control" id="year" min="1970" max="2025" value="2023" required>
            <div class="invalid-feedback">1970~2025 사이의 연도를 입력하세요.</div>
          </div>
          <div class="col-md-3">
            <label class="form-label">장르 *</label>
            <select class="form-select" id="genre" required>
              <option value="">선택</option>
              <option selected>RPG</option>
              <option>Action</option>
              <option>Adventure</option>
              <option>Sim</option>
              <option>Racing</option>
              <option>Strategy</option>
              <option>Puzzle</option>
              <option>Indie</option>
            </select>
            <div class="invalid-feedback">장르를 선택하세요.</div>
          </div>
          <div class="col-md-6">
            <label class="form-label">그래픽 사양 (최소) *</label>
            <input type="text" class="form-control" id="gpuMin" value="GTX 960 / 8GB RAM" required>
            <div class="invalid-feedback">최소 사양을 입력하세요(10자 이상).</div>
          </div>
          <div class="col-md-6">
            <label class="form-label">그래픽 사양 (권장) *</label>
            <input type="text" class="form-control" id="gpuRec" value="RTX 2060 / 16GB RAM" required>
            <div class="invalid-feedback">권장 사양을 입력하세요(10자 이상).</div>
          </div>
        </div>

        <div class="d-flex gap-2 mt-4">
          <button type="submit" class="btn btn-primary">확인</button>
          <a href="index.html" class="btn btn-outline-secondary">취소</a>
        </div>
      </form>
    </div>
  </div>
</main>

<footer class="text-center text-muted py-4">
  <small>© 2025 Game CRUD Demo</small>
</footer>

<script>
  const form = document.getElementById('editForm');
  form.addEventListener('submit', function(e){
    let valid = true;
    const title = document.getElementById('title');
    if(!(title.value.trim().length >= 2 && title.value.trim().length <= 60)){
      valid = false; title.classList.add('is-invalid');
    }else{ title.classList.remove('is-invalid'); }

    const price = document.getElementById('price');
    if(!(price.value !== '' && Number(price.value) >= 0)){
      valid = false; price.classList.add('is-invalid');
    }else{ price.classList.remove('is-invalid'); }

    const hours = document.getElementById('hours');
    if(!(hours.value !== '' && Number.isInteger(Number(hours.value)) && Number(hours.value) >= 0)){
      valid = false; hours.classList.add('is-invalid');
    }else{ hours.classList.remove('is-invalid'); }

    const dev = document.getElementById('dev');
    if(!(dev.value.trim().length >= 2 && dev.value.trim().length <= 40)){
      valid = false; dev.classList.add('is-invalid');
    }else{ dev.classList.remove('is-invalid'); }

    const year = document.getElementById('year');
    const y = Number(year.value);
    if(!(y >= 1970 && y <= 2025)){
      valid = false; year.classList.add('is-invalid');
    }else{ year.classList.remove('is-invalid'); }

    const genre = document.getElementById('genre');
    if(genre.value === ''){
      valid = false; genre.classList.add('is-invalid');
    }else{ genre.classList.remove('is-invalid'); }

    const gpuMin = document.getElementById('gpuMin');
    if(gpuMin.value.trim().length < 10){
      valid = false; gpuMin.classList.add('is-invalid');
    }else{ gpuMin.classList.remove('is-invalid'); }

    const gpuRec = document.getElementById('gpuRec');
    if(gpuRec.value.trim().length < 10){
      valid = false; gpuRec.classList.add('is-invalid');
    }else{ gpuRec.classList.remove('is-invalid'); }

    if(!valid){
      e.preventDefault();
      e.stopPropagation();
      return;
    }

    e.preventDefault();
    if(confirm('게시물을 수정할까요?')){
      window.location.href = 'view.html';
    }
  });
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

<!-- 
--------------------정리------------------------

my.css[모바일, 데스크탑 환경 반응]와 Bootstrap 공통 스타일 적용

const form = document.getElementById('gameFormEdit');
 -> getElementById 함수를 통해 DOM 요소(form)를 가져옴

form.addEventListener('submit', function(e) {...});
 -> form이 제출(submit)될 때마다 지정된 함수 실행

getElementById로 각 입력 필드(총 10가지 속성)를 가져와 값 확인
 -> 게임 이름, 가격, 플레이 시간, 제작사, 출시년도, 장르, 최소 사양, 권장 사양 등
 -> add.html과 동일하지만, 초기값(value)이 미리 채워져 있음 (예시 데이터)

addEventListener 내부에서 검증 로직 수행:
 - 각 속성에 값의 제한 또는 범위가 주어짐
 - 올바르지 않은 값이 입력되면 is-invalid 클래스가 붙고
   Bootstrap이 빨간 경고 UI 표시

동작 흐름:
1) 사용자가 확인 버튼을 눌렀을 때 검증 실패한 필드가 하나라도 있으면
   → ok=false → e.preventDefault() → 폼 제출 중단
   → 잘못된 입력 필드에 is-invalid 클래스 추가 (빨간 테두리 표시)

2) 모든 필드가 조건을 만족하면
   → confirm("게시물을 수정할까요?") 확인 창 표시
   → 확인 시 window.location.href = 'view.html' 실행 (상세 페이지로 이동)

또한 Bootstrap의 is-valid / invalid-feedback 클래스가 연동되어,
사용자가 즉시 에러 메세지 확인 가능
-->